<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard</title>
    <link rel="stylesheet" href="css/styles.css">
</head>

<body>
    <div class="header">
        <div class="header-content">
            <div class="logo">‚öôÔ∏è Admin Dashboard</div>
            <div class="nav-menu">
                <span id="user-name"></span>
                <button class="btn btn-secondary" onclick="api.logout()">Logout</button>
            </div>
        </div>
    </div>

    <div class="container">
        <div id="success-message" class="alert alert-success hidden"></div>
        <div id="error-message" class="alert alert-error hidden"></div>

        <!-- Stats Dashboard -->
        <div class="dashboard-grid">
            <div class="stat-card">
                <h3>Total Students</h3>
                <div class="value" id="total-students">402</div>
            </div>
            <div class="stat-card">
                <h3>Total Teachers</h3>
                <div class="value" id="total-teachers">40</div>
            </div>
            <div class="stat-card">
                <h3>Total Courses</h3>
                <div class="value" id="total-courses">40</div>
            </div>
            <div class="stat-card">
                <h3>System Status</h3>
                <div class="value" style="font-size: 1.5rem; color: var(--success);">‚úì Active</div>
            </div>
        </div>

        <!-- Quick Actions -->
        <div class="card">
            <div class="card-header">‚ö° Quick Actions</div>
            <div class="dashboard-grid">
                <button class="btn btn-primary" onclick="showAddStudentModal()">
                    ‚ûï Add Student
                </button>
                <button class="btn btn-primary" onclick="showAddTeacherModal()">
                    ‚ûï Add Teacher
                </button>
                <button class="btn btn-primary" onclick="showAddCourseModal()">
                    ‚ûï Add Course
                </button>
                <button class="btn btn-success" onclick="generateTimetable()">
                    üìÖ Generate Timetables
                </button>
            </div>
        </div>

        <!-- Students List -->
        <div class="card">
            <div class="card-header">üë®‚Äçüéì Students</div>
            <div id="loading-spinner" class="spinner hidden"></div>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Student ID</th>
                            <th>Name</th>
                            <th>Email</th>
                            <th>Semester</th>
                            <th>Enrolled Courses</th>
                        </tr>
                    </thead>
                    <tbody id="students-list">
                        <tr>
                            <td colspan="5" class="text-center">Click to load students</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <button class="btn btn-primary mt-2" onclick="loadStudents()">Load All Students</button>
        </div>

        <!-- Teachers List -->
        <div class="card">
            <div class="card-header">üë®‚Äçüè´ Teachers</div>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Teacher ID</th>
                            <th>Name</th>
                            <th>Email</th>
                            <th>Department</th>
                            <th>Assigned Course</th>
                        </tr>
                    </thead>
                    <tbody id="teachers-list">
                        <tr>
                            <td colspan="5" class="text-center">Click to load teachers</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <button class="btn btn-primary mt-2" onclick="loadTeachers()">Load All Teachers</button>
        </div>

        <!-- Courses List -->
        <div class="card">
            <div class="card-header">üìö Courses</div>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Course ID</th>
                            <th>Course Name</th>
                            <th>Semester</th>
                            <th>Teacher</th>
                            <th>Enrollment</th>
                        </tr>
                    </thead>
                    <tbody id="courses-list">
                        <tr>
                            <td colspan="5" class="text-center">Click to load courses</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <button class="btn btn-primary mt-2" onclick="loadCourses()">Load All Courses</button>
        </div>
    </div>

    <script src="js/api.js"></script>
    <script src="js/auth.js"></script>
    <script>
        function init() {
            const auth = checkAuth();
            if (!auth) return;

            const userInfo = getUserInfo();
            document.getElementById('user-name').textContent = userInfo.name;
        }

        async function loadStudents() {
            showLoading(true);
            const tbody = document.getElementById('students-list');

            // Mock data
            tbody.innerHTML = `
                <tr>
                    <td>BSCS24119</td>
                    <td>Toheed Ali</td>
                    <td>bscs24119@itu.edu.pk</td>
                    <td>3</td>
                    <td>5</td>
                </tr>
                <tr>
                    <td>BSCS24134</td>
                    <td>Eman Fatima</td>
                    <td>bscs24134@itu.edu.pk</td>
                    <td>3</td>
                    <td>4</td>
                </tr>
                <tr>
                    <td colspan="5" class="text-center" style="color: var(--text-light);">
                        ... and 400 more students
                    </td>
                </tr>
            `;
            showLoading(false);
        }

        async function loadTeachers() {
            showLoading(true);
            const tbody = document.getElementById('teachers-list');

            tbody.innerHTML = `
                <tr>
                    <td>T1300</td>
                    <td>teacher5</td>
                    <td>T1300@itu.edu.pk</td>
                    <td>Computer Science</td>
                    <td>CS301</td>
                </tr>
                <tr>
                    <td>T1301</td>
                    <td>teacher6</td>
                    <td>T1301@itu.edu.pk</td>
                    <td>Computer Science</td>
                    <td>CS302</td>
                </tr>
                <tr>
                    <td colspan="5" class="text-center" style="color: var(--text-light);">
                        ... and 38 more teachers
                    </td>
                </tr>
            `;
            showLoading(false);
        }

        async function loadCourses() {
            showLoading(true);
            const tbody = document.getElementById('courses-list');

            tbody.innerHTML = `
                <tr>
                    <td>CS301</td>
                    <td>Algorithms</td>
                    <td>3</td>
                    <td>teacher5</td>
                    <td>45/50</td>
                </tr>
                <tr>
                    <td>CS302</td>
                    <td>Database Systems</td>
                    <td>3</td>
                    <td>teacher6</td>
                    <td>43/50</td>
                </tr>
                <tr>
                    <td colspan="5" class="text-center" style="color: var(--text-light);">
                        ... and 38 more courses
                    </td>
                </tr>
            `;
            showLoading(false);
        }

        function showAddStudentModal() {
            showError('Add Student feature will be available when backend API is connected');
        }

        function showAddTeacherModal() {
            showError('Add Teacher feature will be available when backend API is connected');
        }

        function showAddCourseModal() {
            showError('Add Course feature will be available when backend API is connected');
        }

        async function generateTimetable() {
            if (!confirm('Generate timetables for all semesters? This may take a moment.')) return;

            showLoading(true);
            try {
                // await api.generateTimetable();
                await new Promise(resolve => setTimeout(resolve, 1500)); // Simulate API call
                showSuccess('Timetables generated successfully for all semesters!');
            } catch (error) {
                showError('Failed to generate timetables: ' + error.message);
            } finally {
                showLoading(false);
            }
        }

        window.addEventListener('DOMContentLoaded', init);
    </script>
</body>

</html>